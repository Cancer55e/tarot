<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>cancer.55e Stella & Tail</title>

<style>
body{
  font-family:sans-serif;
  background:#0a0a1a;
  color:white;
  text-align:center;
  padding:20px;
  max-width:500px;
  margin:auto;
}

.card{
  margin-top:20px;
  padding:20px;
  border-radius:12px;
  background:#1a1a2e;
}

input,button{
  width:100%;
  padding:14px;
  font-size:18px;
  margin-top:12px;
  border-radius:8px;
  border:none;
}

button{
  background:#5c6cff;
  color:white;
  cursor:pointer;
}

</style>
</head>

<body>

<h1>ğŸŒŒ cancer.55e</h1>
<h2>Stella & Tail Calculator</h2>

<input 
type="tel"
id="birth"
placeholder="ä¾‹ï¼š19980715"
maxlength="8"
inputmode="numeric"
/>

<button onclick="calculate()">ç¢ºå®š</button>

<div id="result" class="card"></div>

<script>

// =====================
// è‡ªå‹•ã‚¹ãƒ©ãƒƒã‚·ãƒ¥è£œåŠ©
// =====================
document.getElementById("birth").addEventListener("input", function(){

  let v = this.value.replace(/\D/g,"").slice(0,8);
  this.value = v;

});


// =====================
// å…¥åŠ›è§£æ
// =====================
function parseBirth(){

  let input = document.getElementById("birth").value;

  if(!/^\d{8}$/.test(input)){
    alert("ç”Ÿå¹´æœˆæ—¥ã¯8æ¡ã§å…¥åŠ›ã—ã¦ãã ã•ã„");
    return null;
  }

  let y = Number(input.substring(0,4));
  let m = Number(input.substring(4,6));
  let d = Number(input.substring(6,8));

  return new Date(y, m-1, d);
}


// =====================
// ã‚¹ãƒ†ãƒ©å¯¾å¿œè¡¨
// =====================
const stellaCards = {
3:"GENERATOR ï½ç¾ã®å¥³ç¥ï½",
4:"REIGNS ï½å›è‡¨ã™ã‚‹è€…ï½",
5:"SHAMAN ï½ä¼å°å¸«ï½",
6:"DEAREST ï½æ„›ã‚’ä¸ãˆã‚‹è€…ï½",
7:"VALKYRIE ï½é»„é‡‘æˆ¦è»Šï½",
8:"EUSTITIA ï½è£ãã®å¥³ç¥ï½",
9:"ASTRONOMER ï½å¤©æ–‡å­¦è€…ï½",
10:"PHARAOH ï½è¬ã«åŒ…ã¾ã‚ŒãŸå­˜åœ¨ï½",
11:"HARDY EXPLORER ï½å±ˆå¼·ãªæ¢æ¤œå®¶ï½",
12:"SAMURAI ï½ä¾é­‚ï½",
13:"STARS MAKER ï½æ˜Ÿã‚’ç”Ÿã‚€è€…ï½",
14:"ALL THE RAGE ï½ä¸€ä¸–é¢¨é¡ï½",
15:"REVOLUTIONIST ï½é©å‘½å®¶ï½",
16:"TRANSFORMERS ï½é¾ç¥ï½",
17:"THE HERO ï½å„ªã—ãè‹±é›„ï½",
18:"CLEVER THINKER ï½æœˆã®å¥³ç¥ï½",
19:"THE KING OF KINGS ï½ä¸–ç•Œçš‡å¸ï½",
20:"CELEBRATER ï½å¤©ä½¿ï½",
21:"THE CREATER ï½å‰µé€ ä¸»ï½"
};


// =====================
// ãƒ†ã‚¤ãƒ«ã‚¤ãƒ¤ãƒ¼å¯¾å¿œè¡¨
// =====================
const tailCards = {
0:"NEW BASIS ï½ç„¡ã‹ã‚‰ç”Ÿã¾ã‚Œã‚‹ã‚¹ãƒ†ãƒ¼ã‚¸ï½",
1:"SOW THE SEEDS ï½ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®å§‹å‹•ï½",
2:"ROOTS GROW ï½æ ¹ã‚’å¼µã‚‹ï½",
3:"A VAST FOREST ï½ç”Ÿç”£æ€§ã¨é›†åˆï½",
4:"TACTICS ï½å›è‡¨ã¨çµ„ç¹”ï½",
5:"LEARNING ï½çŸ¥è­˜ã®ç¿’å¾—ï½",
6:"BUDDY ï½ä»²é–“ï½",
7:"SWITCH ï½åˆ‡ã‚Šæ›¿ãˆï½",
8:"JUDGEMENT ï½åˆ¤å®šï½",
9:"DISTANT STAR ï½é ã„æ˜Ÿï½",
10:"MOVEMENT AND CHANGE ï½ç§»å‹•ã¨å¤‰åŒ–ï½",
11:"DIVISION POINT ï½åˆ†å²ç‚¹ï½",
12:"CONTROL ï½å¾‹ã™ã‚‹ï½",
13:"SKIP ABOUT ï½æµ„åŒ–ãƒ»ç§»å‹•ãƒ»é–‹èŠ±ï½",
14:"TRANSFER ï½æ°—ã¥ãã¨æœªæ¥ï½",
15:"DESIRE ï½æ¬²æœ›ã¨ã‚¨ãƒãƒ«ã‚®ãƒ¼ï½",
16:"SCRAP AND BUILD ï½ç ´å£Šã¨å†ç”Ÿï½",
17:"NEW STELLAR ï½æ–°ã—ã„æ˜Ÿï½",
18:"ILLUSION ï½å¹»æƒ³ï½",
19:"CORRECT ï½æ­£è§£ï½",
20:"COMPLETION ï½å®Œçµï½",
21:"A GALAXY ï½æœªæ¥ãŒå‰µã‚‰ã‚Œã‚‹ï½"
};


// =====================
// ã‚¹ãƒ†ãƒ©è¨ˆç®—
// =====================
function calcStella(date){

  let y = date.getFullYear();
  let m = date.getMonth()+1;
  let d = date.getDate();

  let sum = (""+y+m+d)
    .split("")
    .reduce((a,b)=>a+Number(b),0);

  while(sum >= 22){
    sum = sum.toString()
      .split("")
      .reduce((a,b)=>a+Number(b),0);
  }

  return sum;
}


// =====================
// ãƒ†ã‚¤ãƒ«è¨ˆç®—
// =====================
function calcTail(date, stella){

  let today = new Date();

  let age = today.getFullYear() - date.getFullYear();

  let birthdayThisYear =
    new Date(today.getFullYear(), date.getMonth(), date.getDate());

  if(today < birthdayThisYear){
    age--;
  }

  let raw = age + stella;

  let week = Math.floor(raw / 22) + 1;
  let tail = raw % 22;

  return { tail, week, age };
}


// =====================
// è¡¨ç¤º
// =====================
function calculate(){

  let date = parseBirth();
  if(!date) return;

  let stella = calcStella(date);
  let tailData = calcTail(date, stella);

  document.getElementById("result").innerHTML = `

    <h2>çµæœ</h2>

    <h3>â­ ã‚¹ãƒ†ãƒ©ãƒŠãƒ³ãƒãƒ¼ ${stella}</h3>
    <p>${stellaCards[stella] ?? ""}</p>

    <hr>

    <h3>ğŸŒ™ ãƒ†ã‚¤ãƒ«ã‚¤ãƒ¤ãƒ¼ ${tailData.tail}</h3>
    <p>${tailCards[tailData.tail]}</p>

    <p>é€±ç›®ï¼š ${tailData.week}</p>
    <p>ç¾åœ¨å¹´é½¢ï¼š ${tailData.age}</p>
  `;
}

</script>

</body>
</html>
