<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>cancer.55e Stella & Tail</title>

<style>
body{
  font-family: sans-serif;
  background:#0a0a1a;
  color:white;
  text-align:center;
  padding:32px 16px;
}

h1{
  margin-bottom:4px;
}

h2{
  font-weight:normal;
  opacity:0.85;
  margin-top:0;
}

input, button{
  padding:10px;
  font-size:16px;
  margin:8px;
  border-radius:6px;
  border:none;
}

button{
  background:#5c6cff;
  color:white;
  cursor:pointer;
}

.card{
  margin-top:20px;
  padding:20px;
  border-radius:14px;
  background:#1a1a2e;
}

.small{
  font-size:14px;
  opacity:0.8;
}

/* â˜… ã‚¹ãƒ†ãƒ©ç”»åƒç”¨ */
.stella-img{
  width:220px;
  max-width:80vw;
  height:auto;
  margin:14px auto;
  display:block;
  border-radius:14px;
  box-shadow:0 12px 32px rgba(0,0,0,0.45);
}
</style>
</head>

<body>

<h1>ğŸŒŒ cancer.55e</h1>
<h2>Stella & Tail Calculator</h2>

<input type="date" id="birth">
<br>
<button onclick="calculate()">ç¢ºå®š</button>

<div id="result"></div>

<script>
// =====================
// ã‚¹ãƒ†ãƒ©å¯¾å¿œè¡¨
// =====================
const stellaCards = {
  3:"GENERATOR ï½ç¾ã®å¥³ç¥ï½",
  4:"REIGNS ï½å›è‡¨ã™ã‚‹è€…ï½",
  5:"SHAMAN ï½ä¼å°å¸«ï½",
  6:"DEAREST ï½æ„›ã‚’ä¸ãˆã‚‹è€…ï½",
  7:"VALKYRIE ï½é»„é‡‘æˆ¦è»Šï½",
  8:"EUSTITIA ï½è£ãã®å¥³ç¥ï½",
  9:"ASTRONOMER ï½å¤©æ–‡å­¦è€…ï½",
  10:"PHARAOH ï½è¬ã«åŒ…ã¾ã‚ŒãŸå­˜åœ¨ï½",
  11:"HARDY EXPLORER ï½å±ˆå¼·ãªæ¢æ¤œå®¶ï½",
  12:"SAMURAI ï½ä¾é­‚ï½",
  13:"STARS MAKER ï½æ˜Ÿã‚’ç”Ÿã‚€è€…ï½",
  14:"ALL THE RAGE ï½ä¸€ä¸–é¢¨é¡ï½",
  15:"REVOLUTIONIST ï½é©å‘½å®¶ï½",
  16:"TRANSFORMERS ï½é¾ç¥ï½",
  17:"THE HERO ï½å„ªã—ãè‹±é›„ï½",
  18:"CLEVER THINKER ï½æœˆã®å¥³ç¥ï½",
  19:"THE KING OF KINGS ï½ä¸–ç•Œçš‡å¸ï½",
  20:"CELEBRATER ï½å¤©ä½¿ï½",
  21:"THE CREATER ï½å‰µé€ ä¸»ï½"
};

// =====================
// ãƒ†ã‚¤ãƒ«å¯¾å¿œè¡¨
// =====================
const tailCards = {
  0:"NEW BASIS ï½ç„¡ã‹ã‚‰ç”Ÿã¾ã‚Œã‚‹ï½",
  1:"SOW THE SEEDS ï½å§‹å‹•ï½",
  2:"ROOTS GROW ï½æ ¹ã‚’å¼µã‚‹ï½",
  3:"A VAST FOREST ï½é›†åˆã¨ç”Ÿç”£ï½",
  4:"TACTICS ï½æˆ¦ç•¥ï½",
  5:"LEARNING ï½å­¦ã³ï½",
  6:"BUDDY ï½ä»²é–“ï½",
  7:"SWITCH ï½åˆ‡ã‚Šæ›¿ãˆï½",
  8:"JUDGEMENT ï½å‡è¡¡ï½",
  9:"DISTANT STAR ï½å±•æœ›ï½",
  10:"MOVEMENT ï½å¤‰åŒ–ï½",
  11:"DIVISION POINT ï½åˆ†å²ï½",
  12:"CONTROL ï½é›†ä¸­ï½",
  13:"SKIP ABOUT ï½æµ„åŒ–ã¨ç§»å‹•ï½",
  14:"TRANSFER ï½æ°—ã¥ãï½",
  15:"DESIRE ï½æ¬²æœ›ï½",
  16:"SCRAP AND BUILD ï½ç ´å£Šã¨å†ç”Ÿï½",
  17:"NEW STELLAR ï½å¸Œæœ›ï½",
  18:"ILLUSION ï½å¹»æƒ³ï½",
  19:"CORRECT ï½æ±ºå®šï½",
  20:"COMPLETION ï½å®Œçµï½",
  21:"A GALAXY ï½æœªæ¥ï½"
};

// =====================
// â˜… ç”»åƒç”¨ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£
// =====================
function pad2(n){
  return String(n).padStart(2, "0");
}

function stellaImgPath(stella){
  return `img/stella/${pad2(stella)}.png`;
}

// =====================
// ã‚¹ãƒ†ãƒ©è¨ˆç®—
// =====================
function calcStella(date){
  let y = date.getFullYear();
  let m = date.getMonth() + 1;
  let d = date.getDate();

  let sum = ("" + y + m + d)
    .split("")
    .reduce((a,b)=>a + Number(b), 0);

  while(sum >= 22){
    sum = sum.toString()
      .split("")
      .reduce((a,b)=>a + Number(b), 0);
  }

  return sum;
}

// =====================
// ãƒ†ã‚¤ãƒ«ï¼†å‘¨ç›®è¨ˆç®—
// =====================
function calcTail(date, stella){
  const today = new Date();

  let age = today.getFullYear() - date.getFullYear();
  const birthdayThisYear =
    new Date(today.getFullYear(), date.getMonth(), date.getDate());

  if(today < birthdayThisYear){
    age--;
  }

  const raw = age + stella;
  const tail = ((raw % 22) + 22) % 22;
  const week = Math.floor(raw / 22) + 1;

  return { age, tail, week };
}

// =====================
// è¡¨ç¤ºå‡¦ç†
// =====================
function calculate(){

  const birth = document.getElementById("birth").value;
  if(!birth) return;

  const date = new Date(birth);

  const stella = calcStella(date);
  const tailData = calcTail(date, stella);
  const stellaImg = stellaImgPath(stella);

  document.getElementById("result").innerHTML = `
    <div class="card">
      <p class="small">${tailData.age}æ­³ï¼šç¾åœ¨ã®å¹´é½¢</p>

      <h3>â­ ã‚¹ãƒ†ãƒ©ãƒŠãƒ³ãƒãƒ¼ ${stella}</h3>
      <p>${stellaCards[stella] ?? ""}</p>

      <img
        class="stella-img"
        src="${stellaImg}"
        alt="Stella ${stella}"
        onerror="this.style.display='none'"
      >

      <hr>

      <h3>ğŸŒ™ ãƒ†ã‚¤ãƒ«ãƒŠãƒ³ãƒãƒ¼ ${tailData.tail}</h3>
      <p>${tailCards[tailData.tail] ?? ""}</p>

      <p class="small">ç¾åœ¨ï¼š${tailData.week}å‘¨ç›®</p>
    </div>
  `;
}
</script>

</body>
</html>
